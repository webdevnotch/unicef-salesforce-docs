import{_ as s,c as n,o as a,a as o}from"./app.18b2ef50.js";const F=JSON.parse('{"title":"Environment-Specific API Keys","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u{1F3AF} Overview","slug":"\u{1F3AF}-overview","link":"#\u{1F3AF}-overview","children":[]},{"level":2,"title":"\u{1F527} How It Works","slug":"\u{1F527}-how-it-works","link":"#\u{1F527}-how-it-works","children":[{"level":3,"title":"Environment Detection","slug":"environment-detection","link":"#environment-detection","children":[]},{"level":3,"title":"API Key Validation","slug":"api-key-validation","link":"#api-key-validation","children":[]}]},{"level":2,"title":"\u{1F680} API Endpoints","slug":"\u{1F680}-api-endpoints","link":"#\u{1F680}-api-endpoints","children":[{"level":3,"title":"Generate API Key","slug":"generate-api-key","link":"#generate-api-key","children":[]},{"level":3,"title":"Get All API Keys","slug":"get-all-api-keys","link":"#get-all-api-keys","children":[]},{"level":3,"title":"Get Keys by Environment","slug":"get-keys-by-environment","link":"#get-keys-by-environment","children":[]},{"level":3,"title":"Revoke API Key","slug":"revoke-api-key","link":"#revoke-api-key","children":[]},{"level":3,"title":"Delete API Key","slug":"delete-api-key","link":"#delete-api-key","children":[]}]},{"level":2,"title":"\u{1F310} Environment URLs","slug":"\u{1F310}-environment-urls","link":"#\u{1F310}-environment-urls","children":[]},{"level":2,"title":"\u{1F511} API Key Usage","slug":"\u{1F511}-api-key-usage","link":"#\u{1F511}-api-key-usage","children":[{"level":3,"title":"Development","slug":"development","link":"#development","children":[]},{"level":3,"title":"Staging","slug":"staging","link":"#staging","children":[]},{"level":3,"title":"Production","slug":"production","link":"#production","children":[]}]},{"level":2,"title":"\u{1F6E1}\uFE0F Security Features","slug":"\u{1F6E1}\uFE0F-security-features","link":"#\u{1F6E1}\uFE0F-security-features","children":[{"level":3,"title":"Environment Isolation","slug":"environment-isolation","link":"#environment-isolation","children":[]},{"level":3,"title":"Unique Constraint","slug":"unique-constraint","link":"#unique-constraint","children":[]},{"level":3,"title":"Environment Validation","slug":"environment-validation","link":"#environment-validation","children":[]}]},{"level":2,"title":"\u{1F4CA} Database Schema","slug":"\u{1F4CA}-database-schema","link":"#\u{1F4CA}-database-schema","children":[]},{"level":2,"title":"\u{1F504} Migration Guide","slug":"\u{1F504}-migration-guide","link":"#\u{1F504}-migration-guide","children":[{"level":3,"title":"For Existing Users","slug":"for-existing-users","link":"#for-existing-users","children":[]},{"level":3,"title":"For New Users","slug":"for-new-users","link":"#for-new-users","children":[]}]},{"level":2,"title":"\u{1F6A8} Error Handling","slug":"\u{1F6A8}-error-handling","link":"#\u{1F6A8}-error-handling","children":[{"level":3,"title":"Invalid Environment Key","slug":"invalid-environment-key","link":"#invalid-environment-key","children":[]},{"level":3,"title":"Missing API Key","slug":"missing-api-key","link":"#missing-api-key","children":[]},{"level":3,"title":"Inactive User","slug":"inactive-user","link":"#inactive-user","children":[]}]},{"level":2,"title":"\u{1F4A1} Best Practices","slug":"\u{1F4A1}-best-practices","link":"#\u{1F4A1}-best-practices","children":[{"level":3,"title":"Key Management","slug":"key-management","link":"#key-management","children":[]},{"level":3,"title":"Environment Separation","slug":"environment-separation","link":"#environment-separation","children":[]},{"level":3,"title":"Development Workflow","slug":"development-workflow","link":"#development-workflow","children":[]}]},{"level":2,"title":"\u{1F527} Configuration","slug":"\u{1F527}-configuration","link":"#\u{1F527}-configuration","children":[{"level":3,"title":"Environment Variables","slug":"environment-variables","link":"#environment-variables","children":[]},{"level":3,"title":"Nginx Configuration","slug":"nginx-configuration","link":"#nginx-configuration","children":[]}]},{"level":2,"title":"\u{1F389} Benefits","slug":"\u{1F389}-benefits","link":"#\u{1F389}-benefits","children":[]},{"level":2,"title":"\u{1F198} Troubleshooting","slug":"\u{1F198}-troubleshooting","link":"#\u{1F198}-troubleshooting","children":[{"level":3,"title":"Key Not Working","slug":"key-not-working","link":"#key-not-working","children":[]},{"level":3,"title":"Environment Detection Issues","slug":"environment-detection-issues","link":"#environment-detection-issues","children":[]},{"level":3,"title":"Database Issues","slug":"database-issues","link":"#database-issues","children":[]}]}],"relativePath":"backend/ENVIRONMENT_API_KEYS.md"}'),e={name:"backend/ENVIRONMENT_API_KEYS.md"},l=o(`<h1 id="environment-specific-api-keys" tabindex="-1">Environment-Specific API Keys <a class="header-anchor" href="#environment-specific-api-keys" aria-hidden="true">#</a></h1><p>This document explains how to use API keys across different environments (development, staging, production) in the SF Middleware.</p><h2 id="\u{1F3AF}-overview" tabindex="-1">\u{1F3AF} <strong>Overview</strong> <a class="header-anchor" href="#\u{1F3AF}-overview" aria-hidden="true">#</a></h2><p>Users can now have separate API keys for each environment:</p><ul><li><strong>Development</strong> - For local development and testing</li><li><strong>Staging</strong> - For testing and integration</li><li><strong>Production</strong> - For live production use</li><li><strong>Production2</strong> - For secondary production environment (if configured)</li></ul><h2 id="\u{1F527}-how-it-works" tabindex="-1">\u{1F527} <strong>How It Works</strong> <a class="header-anchor" href="#\u{1F527}-how-it-works" aria-hidden="true">#</a></h2><h3 id="environment-detection" tabindex="-1"><strong>Environment Detection</strong> <a class="header-anchor" href="#environment-detection" aria-hidden="true">#</a></h3><p>The system automatically detects the environment from:</p><ol><li><p><strong>Subdomain</strong> (Recommended)</p><ul><li><code>localhost:3000</code> \u2192 Development</li><li><code>staging-api.yourdomain.com</code> \u2192 Staging</li><li><code>api.yourdomain.com</code> \u2192 Production</li></ul></li><li><p><strong>Header</strong> (Alternative)</p><ul><li><code>x-environment: development</code></li><li><code>x-environment: staging</code></li><li><code>x-environment: production</code></li></ul></li><li><p><strong>Environment Variable</strong> (Fallback)</p><ul><li><code>NODE_ENV=development</code> \u2192 Development</li><li><code>NODE_ENV=staging</code> \u2192 Staging</li><li><code>NODE_ENV=production</code> \u2192 Production</li></ul></li></ol><h3 id="api-key-validation" tabindex="-1"><strong>API Key Validation</strong> <a class="header-anchor" href="#api-key-validation" aria-hidden="true">#</a></h3><p>Each API key is tied to a specific environment. A key created for staging won&#39;t work in production and vice versa.</p><p><strong>Security Features:</strong></p><ul><li>API keys are stored with <strong>SHA-256 hash</strong> for fast validation lookup</li><li>Keys are <strong>encrypted</strong> for secure storage and retrieval</li><li>Each user can have only <strong>one API key per environment</strong></li><li>Keys are validated against both the hash and the encrypted version</li></ul><h2 id="\u{1F680}-api-endpoints" tabindex="-1">\u{1F680} <strong>API Endpoints</strong> <a class="header-anchor" href="#\u{1F680}-api-endpoints" aria-hidden="true">#</a></h2><h3 id="generate-api-key" tabindex="-1"><strong>Generate API Key</strong> <a class="header-anchor" href="#generate-api-key" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">POST /api-key/generate</span></span>
<span class="line"><span style="color:#A6ACCD;">Authorization: Bearer </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">jwt-token</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Type: application/json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">My Production Key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">For production use</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">permissions</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">read</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">write</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">environment</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">production</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p><strong>Response:</strong></p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sk_abc123...</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">environment</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">production</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">My Production Key</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="get-all-api-keys" tabindex="-1"><strong>Get All API Keys</strong> <a class="header-anchor" href="#get-all-api-keys" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">GET /api-key/keys</span></span>
<span class="line"><span style="color:#A6ACCD;">Authorization: Bearer </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">jwt-token</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p><strong>Response:</strong></p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">key1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sk_abc123...</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Development Key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">environment</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">development</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">permissions</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">read</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">createdAt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2025-01-01T00:00:00Z</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">key2</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sk_def456...</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Production Key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">environment</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">production</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">permissions</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">read</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">write</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">createdAt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2025-01-01T00:00:00Z</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><h3 id="get-keys-by-environment" tabindex="-1"><strong>Get Keys by Environment</strong> <a class="header-anchor" href="#get-keys-by-environment" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">GET /api-key/keys/staging</span></span>
<span class="line"><span style="color:#A6ACCD;">Authorization: Bearer </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">jwt-token</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="revoke-api-key" tabindex="-1"><strong>Revoke API Key</strong> <a class="header-anchor" href="#revoke-api-key" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">POST /api-key/revoke</span></span>
<span class="line"><span style="color:#A6ACCD;">Authorization: Bearer </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">jwt-token</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Type: application/json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sk_abc123...</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="delete-api-key" tabindex="-1"><strong>Delete API Key</strong> <a class="header-anchor" href="#delete-api-key" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">POST /api-key/delete</span></span>
<span class="line"><span style="color:#A6ACCD;">Authorization: Bearer </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">jwt-token</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Type: application/json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sk_abc123...</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="\u{1F310}-environment-urls" tabindex="-1">\u{1F310} <strong>Environment URLs</strong> <a class="header-anchor" href="#\u{1F310}-environment-urls" aria-hidden="true">#</a></h2><table><thead><tr><th>Environment</th><th>URL</th><th>Description</th></tr></thead><tbody><tr><td>Development</td><td><code>http://localhost:3000</code></td><td>Local development</td></tr><tr><td>Staging</td><td><a href="https://staging-api.yourdomain.com" target="_blank" rel="noreferrer">https://staging-api.yourdomain.com</a></td><td>Testing environment</td></tr><tr><td>Production</td><td><a href="https://api.yourdomain.com" target="_blank" rel="noreferrer">https://api.yourdomain.com</a></td><td>Live production</td></tr><tr><td>Production2</td><td><a href="https://api2.yourdomain.com" target="_blank" rel="noreferrer">https://api2.yourdomain.com</a></td><td>Secondary production (if configured)</td></tr></tbody></table><h2 id="\u{1F511}-api-key-usage" tabindex="-1">\u{1F511} <strong>API Key Usage</strong> <a class="header-anchor" href="#\u{1F511}-api-key-usage" aria-hidden="true">#</a></h2><h3 id="development" tabindex="-1"><strong>Development</strong> <a class="header-anchor" href="#development" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># Using subdomain detection</span></span>
<span class="line"><span style="color:#A6ACCD;">curl -H </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">x-api-key: sk_dev_123...</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">     http://localhost:3000/v1/salesforce/token</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># Using header</span></span>
<span class="line"><span style="color:#A6ACCD;">curl -H </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">x-api-key: sk_dev_123...</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">     -H </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">x-environment: development</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">     http://localhost:3000/v1/salesforce/token</span></span>
<span class="line"></span></code></pre></div><h3 id="staging" tabindex="-1"><strong>Staging</strong> <a class="header-anchor" href="#staging" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># Using subdomain detection</span></span>
<span class="line"><span style="color:#A6ACCD;">curl -H </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">x-api-key: sk_staging_123...</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">     https://staging-api.yourdomain.com/v1/salesforce/token</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># Using header</span></span>
<span class="line"><span style="color:#A6ACCD;">curl -H </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">x-api-key: sk_staging_123...</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">     -H </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">x-environment: staging</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">     https://api.yourdomain.com/v1/salesforce/token</span></span>
<span class="line"></span></code></pre></div><h3 id="production" tabindex="-1"><strong>Production</strong> <a class="header-anchor" href="#production" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># Using subdomain detection</span></span>
<span class="line"><span style="color:#A6ACCD;">curl -H </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">x-api-key: sk_prod_123...</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">     https://api.yourdomain.com/v1/salesforce/token</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># Using header</span></span>
<span class="line"><span style="color:#A6ACCD;">curl -H </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">x-api-key: sk_prod_123...</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">     -H </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">x-environment: production</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">     https://api.yourdomain.com/v1/salesforce/token</span></span>
<span class="line"></span></code></pre></div><h2 id="\u{1F6E1}\uFE0F-security-features" tabindex="-1">\u{1F6E1}\uFE0F <strong>Security Features</strong> <a class="header-anchor" href="#\u{1F6E1}\uFE0F-security-features" aria-hidden="true">#</a></h2><h3 id="environment-isolation" tabindex="-1"><strong>Environment Isolation</strong> <a class="header-anchor" href="#environment-isolation" aria-hidden="true">#</a></h3><ul><li>API keys are isolated by environment</li><li>A staging key cannot access production data</li><li>A development key cannot access staging data</li></ul><h3 id="unique-constraint" tabindex="-1"><strong>Unique Constraint</strong> <a class="header-anchor" href="#unique-constraint" aria-hidden="true">#</a></h3><ul><li>Each user can have only <strong>one API key per environment</strong></li><li>Prevents key duplication and confusion</li></ul><h3 id="environment-validation" tabindex="-1"><strong>Environment Validation</strong> <a class="header-anchor" href="#environment-validation" aria-hidden="true">#</a></h3><ul><li>Keys are validated against the current environment</li><li>Invalid environment keys are rejected with clear error messages</li></ul><h2 id="\u{1F4CA}-database-schema" tabindex="-1">\u{1F4CA} <strong>Database Schema</strong> <a class="header-anchor" href="#\u{1F4CA}-database-schema" aria-hidden="true">#</a></h2><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">-- ApiKey table with environment support</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ApiKey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TEXT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TEXT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">,  </span><span style="color:#676E95;">-- Encrypted API key (for decryption/display)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">keyHash</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TEXT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">UNIQUE</span><span style="color:#A6ACCD;">,  </span><span style="color:#676E95;">-- SHA-256 hash of plain key (for fast validation lookup)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TEXT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TEXT</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">isActive</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">BOOLEAN</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DEFAULT</span><span style="color:#A6ACCD;"> true,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">permissions</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TEXT</span><span style="color:#A6ACCD;">[] </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">environment</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TEXT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DEFAULT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">production</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">userId</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TEXT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">createdAt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TIMESTAMP</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DEFAULT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CURRENT_TIMESTAMP</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">updatedAt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TIMESTAMP</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">CONSTRAINT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ApiKey_pkey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">PRIMARY</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">KEY</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">CONSTRAINT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ApiKey_userId_environment_key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">UNIQUE</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">userId</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">environment</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">CONSTRAINT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ApiKey_keyHash_key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">UNIQUE</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">keyHash</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p><strong>Key Storage:</strong></p><ul><li><code>key</code>: Encrypted version of the API key (for decryption when displaying to user)</li><li><code>keyHash</code>: SHA-256 hash of the plain key (for fast validation lookup during authentication)</li><li>Both are stored for different use cases: hash for fast validation, encrypted for retrieval</li></ul><h2 id="\u{1F504}-migration-guide" tabindex="-1">\u{1F504} <strong>Migration Guide</strong> <a class="header-anchor" href="#\u{1F504}-migration-guide" aria-hidden="true">#</a></h2><h3 id="for-existing-users" tabindex="-1"><strong>For Existing Users</strong> <a class="header-anchor" href="#for-existing-users" aria-hidden="true">#</a></h3><ol><li><strong>Existing API keys</strong> will default to <code>production</code> environment</li><li><strong>Create new keys</strong> for staging and development as needed</li><li><strong>Update your applications</strong> to use environment-specific keys</li></ol><h3 id="for-new-users" tabindex="-1"><strong>For New Users</strong> <a class="header-anchor" href="#for-new-users" aria-hidden="true">#</a></h3><ol><li><strong>Create account</strong> and get JWT token</li><li><strong>Generate keys</strong> for each environment you need</li><li><strong>Use appropriate key</strong> for each environment</li></ol><h2 id="\u{1F6A8}-error-handling" tabindex="-1">\u{1F6A8} <strong>Error Handling</strong> <a class="header-anchor" href="#\u{1F6A8}-error-handling" aria-hidden="true">#</a></h2><h3 id="invalid-environment-key" tabindex="-1"><strong>Invalid Environment Key</strong> <a class="header-anchor" href="#invalid-environment-key" aria-hidden="true">#</a></h3><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">statusCode</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">401</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">message</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Invalid API key for staging environment</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">error</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Unauthorized</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="missing-api-key" tabindex="-1"><strong>Missing API Key</strong> <a class="header-anchor" href="#missing-api-key" aria-hidden="true">#</a></h3><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">statusCode</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">401</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">message</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">API key required</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">error</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Unauthorized</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="inactive-user" tabindex="-1"><strong>Inactive User</strong> <a class="header-anchor" href="#inactive-user" aria-hidden="true">#</a></h3><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">statusCode</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">401</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">message</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">User account is inactive</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">error</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Unauthorized</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="\u{1F4A1}-best-practices" tabindex="-1">\u{1F4A1} <strong>Best Practices</strong> <a class="header-anchor" href="#\u{1F4A1}-best-practices" aria-hidden="true">#</a></h2><h3 id="key-management" tabindex="-1"><strong>Key Management</strong> <a class="header-anchor" href="#key-management" aria-hidden="true">#</a></h3><ol><li><strong>Use descriptive names</strong> for your API keys</li><li><strong>Rotate keys regularly</strong> for security</li><li><strong>Use minimal permissions</strong> (principle of least privilege)</li><li><strong>Store keys securely</strong> (environment variables, secret managers)</li></ol><h3 id="environment-separation" tabindex="-1"><strong>Environment Separation</strong> <a class="header-anchor" href="#environment-separation" aria-hidden="true">#</a></h3><ol><li><strong>Never use production keys</strong> in development</li><li><strong>Test with staging keys</strong> before production</li><li><strong>Use different keys</strong> for different applications</li><li><strong>Monitor key usage</strong> across environments</li></ol><h3 id="development-workflow" tabindex="-1"><strong>Development Workflow</strong> <a class="header-anchor" href="#development-workflow" aria-hidden="true">#</a></h3><ol><li><strong>Start with development</strong> environment</li><li><strong>Test with staging</strong> environment</li><li><strong>Deploy to production</strong> with production keys</li><li><strong>Monitor and maintain</strong> all environments</li></ol><h2 id="\u{1F527}-configuration" tabindex="-1">\u{1F527} <strong>Configuration</strong> <a class="header-anchor" href="#\u{1F527}-configuration" aria-hidden="true">#</a></h2><h3 id="environment-variables" tabindex="-1"><strong>Environment Variables</strong> <a class="header-anchor" href="#environment-variables" aria-hidden="true">#</a></h3><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"># Development</span></span>
<span class="line"><span style="color:#A6ACCD;">NODE_ENV=development</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># Staging</span></span>
<span class="line"><span style="color:#A6ACCD;">NODE_ENV=staging</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># Production</span></span>
<span class="line"><span style="color:#A6ACCD;">NODE_ENV=production</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h3 id="nginx-configuration" tabindex="-1"><strong>Nginx Configuration</strong> <a class="header-anchor" href="#nginx-configuration" aria-hidden="true">#</a></h3><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># Development</span></span>
<span class="line"><span style="color:#C792EA;">server</span><span style="color:#A6ACCD;"> {</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> server_name </span><span style="color:#A6ACCD;">localhost</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># ... other config</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># Staging</span></span>
<span class="line"><span style="color:#C792EA;">server</span><span style="color:#A6ACCD;"> {</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> server_name </span><span style="color:#A6ACCD;">staging-api.yourdomain.com</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># ... other config</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># Production</span></span>
<span class="line"><span style="color:#C792EA;">server</span><span style="color:#A6ACCD;"> {</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> server_name </span><span style="color:#A6ACCD;">api.yourdomain.com</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># ... other config</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="\u{1F389}-benefits" tabindex="-1">\u{1F389} <strong>Benefits</strong> <a class="header-anchor" href="#\u{1F389}-benefits" aria-hidden="true">#</a></h2><ul><li>\u2705 <strong>Environment Isolation</strong> - Keys work only in their intended environment</li><li>\u2705 <strong>Security</strong> - Prevents accidental cross-environment access</li><li>\u2705 <strong>Flexibility</strong> - Different permissions per environment</li><li>\u2705 <strong>Monitoring</strong> - Track usage per environment</li><li>\u2705 <strong>Compliance</strong> - Meet security requirements</li><li>\u2705 <strong>Scalability</strong> - Easy to manage multiple environments</li></ul><h2 id="\u{1F198}-troubleshooting" tabindex="-1">\u{1F198} <strong>Troubleshooting</strong> <a class="header-anchor" href="#\u{1F198}-troubleshooting" aria-hidden="true">#</a></h2><h3 id="key-not-working" tabindex="-1"><strong>Key Not Working</strong> <a class="header-anchor" href="#key-not-working" aria-hidden="true">#</a></h3><ol><li>Check if the key is for the correct environment</li><li>Verify the key is active</li><li>Check if the user account is active</li><li>Verify the environment detection logic</li></ol><h3 id="environment-detection-issues" tabindex="-1"><strong>Environment Detection Issues</strong> <a class="header-anchor" href="#environment-detection-issues" aria-hidden="true">#</a></h3><ol><li>Check subdomain configuration</li><li>Verify header format</li><li>Check environment variables</li><li>Review Nginx configuration</li></ol><h3 id="database-issues" tabindex="-1"><strong>Database Issues</strong> <a class="header-anchor" href="#database-issues" aria-hidden="true">#</a></h3><ol><li>Run migrations: <code>npx prisma migrate deploy</code></li><li>Check database connection</li><li>Verify schema is up to date</li><li>Check unique constraints</li></ol><hr><p><strong>Need help?</strong> Check the <a href="./API_DOCUMENTATION.html">API Documentation</a> or contact support.</p>`,83),t=[l];function p(r,i,c,y,D,C){return a(),n("div",null,t)}const A=s(e,[["render",p]]);export{F as __pageData,A as default};
